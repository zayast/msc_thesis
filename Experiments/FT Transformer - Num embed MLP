{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":8634,"status":"ok","timestamp":1760957119751,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"QYO-HYkgZ4T3"},"outputs":[],"source":["import torch\n","import torch.nn as nn\n","import pandas as pd\n","import numpy as np\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.metrics import accuracy_score\n","from torch.utils.data import DataLoader, TensorDataset\n","from torch.optim import Adam\n","from sklearn.model_selection import train_test_split\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"VdpcwaM9z4TN","executionInfo":{"status":"ok","timestamp":1760957119763,"user_tz":-480,"elapsed":5,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"outputs":[],"source":["from sklearn.metrics import accuracy_score, confusion_matrix, ConfusionMatrixDisplay\n","from sklearn.metrics import precision_score, recall_score, f1_score, classification_report\n","from sklearn.metrics import roc_auc_score, precision_recall_curve, f1_score"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19310,"status":"ok","timestamp":1760957141827,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"7lEomYw8aQbh","outputId":"6e414075-5bce-4195-b45c-486fd606ed15"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"5Q9MHkvXys9q"},"source":["=====================Data prepration============================="]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":4,"status":"ok","timestamp":1760957143076,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"JEb6Fm_HcbCy"},"outputs":[],"source":["# -----------------\n","# Helper: stratified sampling\n","# -----------------\n","def stratified_sample(df, target_col, frac=None, n=None, random_state=42):\n","    \"\"\"Return stratified sample keeping target ratio\"\"\"\n","    if frac is not None:\n","        df_sampled = df.groupby(target_col, group_keys=False)\\\n","                       .apply(lambda x: x.sample(frac=frac, random_state=random_state))\n","    elif n is not None:\n","        class_counts = df[target_col].value_counts()\n","        total = class_counts.sum()\n","        df_sampled = []\n","        for c, count in class_counts.items():\n","            take = int(n * (count / total))\n","            df_sampled.append(df[df[target_col] == c].sample(n=take, random_state=random_state))\n","        df_sampled = pd.concat(df_sampled)\n","    else:\n","        df_sampled = df\n","    return df_sampled.sample(frac=1.0, random_state=random_state).reset_index(drop=True)"]},{"cell_type":"code","source":["dataset = \"B\"\n","\n","if dataset == \"A\":\n","  dataset_name = \"/content/drive/MyDrive/wustl_iiot_2021.csv\"\n","  target = 'Target'\n","  drop_cols = [\"StartTime\", \"LastTime\", \"Traffic\", \"SrcAddr\", \"DstAddr\"]\n","  frac=0.1\n","elif dataset == \"B\":\n","  dataset_name = \"/content/drive/MyDrive/creditcard.csv\"\n","  target = 'Class'\n","  drop_cols = [\"Time\"]\n","  frac=0.5"],"metadata":{"id":"zNLyODO3h4nL","executionInfo":{"status":"ok","timestamp":1760957145036,"user_tz":-480,"elapsed":6,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7858,"status":"ok","timestamp":1760957156349,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"tqQUooD0aAPH","outputId":"d088cd5f-8141-479c-e926-95c70e10c221"},"outputs":[{"output_type":"stream","name":"stdout","text":["Original dataset shape: (284807, 30), anomaly ratio=0.1727%\n","Sampled dataset shape: (142404, 30), anomaly ratio=0.1727%\n"]},{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-2184620091.py:8: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.\n","  .apply(lambda x: x.sample(frac=frac, random_state=random_state))\n"]},{"output_type":"stream","name":"stdout","text":["Train shape: (75948, 30), anomaly ratio=0.1725%\n","Valid shape: (37975, 30), anomaly ratio=0.1738%\n","Test shape:  (28481, 30),  anomaly ratio=0.1720%\n","['V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'Amount']\n","['Set']\n","[]\n"]}],"source":["df = pd.read_csv(dataset_name)\n","\n","df = df.drop(columns=[c for c in drop_cols if c in df.columns])\n","\n","print(f\"Original dataset shape: {df.shape}, anomaly ratio={df[target].mean():.4%}\")\n","\n","# Stratified sampling\n","df_sampled = stratified_sample(df, target, frac=frac, random_state=0)\n","print(f\"Sampled dataset shape: {df_sampled.shape}, anomaly ratio={df_sampled[target].mean():.4%}\")\n","\n","df_sampled = df_sampled.reset_index(drop=True)\n","\n","features = df_sampled.columns\n","\n","train_df, test_df = train_test_split(\n","    df_sampled, test_size=0.2, stratify=df_sampled[target], random_state=0\n",")\n","\n","train_df, valid_df = train_test_split(\n","    train_df, test_size= 0.2 / 0.6, stratify=train_df[target], random_state=0\n",")\n","\n","print(f\"Train shape: {train_df.shape}, anomaly ratio={train_df[target].mean():.4%}\")\n","print(f\"Valid shape: {valid_df.shape}, anomaly ratio={valid_df[target].mean():.4%}\")\n","print(f\"Test shape:  {test_df.shape},  anomaly ratio={test_df[target].mean():.4%}\")\n","\n","# Add the \"Set\" column\n","train_df[\"Set\"] = \"train\"\n","valid_df[\"Set\"] = \"valid\"\n","test_df[\"Set\"] = \"test\"\n","\n","# Combine them back together\n","train = pd.concat([train_df, valid_df, test_df]).reset_index(drop=True)\n","\n","train_indices = train[train.Set == \"train\"].index\n","valid_indices = train[train.Set == \"valid\"].index\n","test_indices = train[train.Set == \"test\"].index\n","\n","\n","categorical_columns = []\n","categorical_dims = {}\n","\n","nunique = train.nunique()\n","types = train.dtypes\n","\n","for col in train.columns:\n","    if types[col] == 'object':\n","        l_enc = LabelEncoder()\n","        train[col] = train[col].fillna(\"VV_likely\")\n","        train[col] = l_enc.fit_transform(train[col].values)\n","        categorical_columns.append(col)\n","        categorical_dims[col] = len(l_enc.classes_)\n","    else:\n","        train.fillna(train.loc[train_indices, col].mean(), inplace=True)\n","\n","unused_feat = [\"Set\"]\n","\n","features = [col for col in df_sampled.columns if col not in unused_feat + [target]]\n","\n","print(features)\n","\n","cat_idxs = [i for i, f in enumerate(features) if f in categorical_columns]\n","\n","cat_dims = [categorical_dims[f] for i, f in enumerate(features) if f in categorical_columns]\n","\n","print(categorical_columns)\n","print(cat_dims)"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1760957160058,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"c-yxDUQHxt6F"},"outputs":[],"source":["target_enc = LabelEncoder()\n","train[target] = target_enc.fit_transform(train[target].values)"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1760957161767,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"oXFTqW5IblTA"},"outputs":[],"source":["X_train = train[features].values[train_indices]\n","y_train = train[target].values[train_indices]\n","\n","X_valid = train[features].values[valid_indices]\n","y_valid = train[target].values[valid_indices]\n","\n","X_test = train[features].values[test_indices]\n","y_test = train[target].values[test_indices]"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"elapsed":79,"status":"ok","timestamp":1760957163748,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"XEizQZmXgxQm"},"outputs":[],"source":["# Split the data into categorical and continuous parts\n","X_train_categ = torch.tensor(X_train[:, cat_idxs], dtype=torch.long)\n","X_train_cont = torch.tensor(np.delete(X_train, cat_idxs, axis=1), dtype=torch.float32)\n","y_train_tensor = torch.tensor(y_train, dtype=torch.long)\n","\n","X_valid_categ = torch.tensor(X_valid[:, cat_idxs], dtype=torch.long)\n","X_valid_cont = torch.tensor(np.delete(X_valid, cat_idxs, axis=1), dtype=torch.float32)\n","y_valid_tensor = torch.tensor(y_valid, dtype=torch.long)\n","\n","X_test_categ = torch.tensor(X_test[:, cat_idxs], dtype=torch.long)\n","X_test_cont = torch.tensor(np.delete(X_test, cat_idxs, axis=1), dtype=torch.float32)\n","y_test_tensor = torch.tensor(y_test, dtype=torch.long)\n","\n","# Create DataLoaders\n","train_dataset = TensorDataset(X_train_categ, X_train_cont, y_train_tensor)\n","train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)\n","\n","valid_dataset = TensorDataset(X_valid_categ, X_valid_cont, y_valid_tensor)\n","valid_loader = DataLoader(valid_dataset, batch_size=32, shuffle=False)\n","\n","test_dataset = TensorDataset(X_test_categ, X_test_cont, y_test_tensor)\n","test_loader = DataLoader(test_dataset, batch_size=32, shuffle=False)"]},{"cell_type":"markdown","metadata":{"id":"6t0AMSr8y2Pe"},"source":["======================================================================"]},{"cell_type":"markdown","metadata":{"id":"Lbv9mESCyQNX"},"source":["==================================Model================================"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":58,"status":"ok","timestamp":1760957165909,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"t9qv3vmlzpQx"},"outputs":[],"source":["import torch\n","import torch.nn.functional as F\n","from torch import nn, einsum\n","\n","from einops import rearrange"]},{"cell_type":"code","execution_count":39,"metadata":{"executionInfo":{"elapsed":4,"status":"ok","timestamp":1760961459333,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"5UmJ2xwyy-AA"},"outputs":[],"source":["import torch\n","import torch.nn.functional as F\n","from torch import nn, einsum\n","\n","from einops import rearrange, repeat\n","\n","# feedforward and attention\n","\n","class GEGLU(nn.Module):\n","    def forward(self, x):\n","        x, gates = x.chunk(2, dim = -1)\n","        return x * F.gelu(gates)\n","\n","def FeedForward(dim, mult = 4, dropout = 0.):\n","    return nn.Sequential(\n","        nn.LayerNorm(dim),\n","        nn.Linear(dim, dim * mult * 2),\n","        GEGLU(),\n","        nn.Dropout(dropout),\n","        nn.Linear(dim * mult, dim)\n","    )\n","\n","class Attention(nn.Module):\n","    def __init__(\n","        self,\n","        dim,\n","        heads = 8,\n","        dim_head = 64,\n","        dropout = 0.\n","    ):\n","        super().__init__()\n","        inner_dim = dim_head * heads\n","        self.heads = heads\n","        self.scale = dim_head ** -0.5\n","\n","        self.norm = nn.LayerNorm(dim)\n","\n","        self.to_qkv = nn.Linear(dim, inner_dim * 3, bias = False)\n","        self.to_out = nn.Linear(inner_dim, dim, bias = False)\n","\n","        self.dropout = nn.Dropout(dropout)\n","\n","    def forward(self, x):\n","        h = self.heads\n","\n","        x = self.norm(x)\n","\n","        q, k, v = self.to_qkv(x).chunk(3, dim = -1)\n","        q, k, v = map(lambda t: rearrange(t, 'b n (h d) -> b h n d', h = h), (q, k, v))\n","        q = q * self.scale\n","\n","        sim = einsum('b h i d, b h j d -> b h i j', q, k)\n","\n","        attn = sim.softmax(dim = -1)\n","        dropped_attn = self.dropout(attn)\n","\n","        out = einsum('b h i j, b h j d -> b h i d', dropped_attn, v)\n","        out = rearrange(out, 'b h n d -> b n (h d)', h = h)\n","        out = self.to_out(out)\n","\n","        return out, attn\n","\n","# transformer\n","\n","class Transformer(nn.Module):\n","    def __init__(\n","        self,\n","        dim,\n","        depth,\n","        heads,\n","        dim_head,\n","        attn_dropout,\n","        ff_dropout\n","    ):\n","        super().__init__()\n","        self.layers = nn.ModuleList([])\n","\n","        for _ in range(depth):\n","            self.layers.append(nn.ModuleList([\n","                Attention(dim, heads = heads, dim_head = dim_head, dropout = attn_dropout),\n","                FeedForward(dim, dropout = ff_dropout),\n","            ]))\n","\n","    def forward(self, x, return_attn = False):\n","        post_softmax_attns = []\n","\n","        for attn, ff in self.layers:\n","            attn_out, post_softmax_attn = attn(x)\n","            post_softmax_attns.append(post_softmax_attn)\n","\n","            x = attn_out + x\n","            x = ff(x) + x\n","\n","        if not return_attn:\n","            return x\n","\n","        return x, torch.stack(post_softmax_attns)\n","\n","# numerical embedder\n","\n","class NumericalEmbedder(nn.Module):\n","    def __init__(self, dim, num_numerical_types):\n","        super().__init__()\n","        self.weights = nn.Parameter(torch.randn(num_numerical_types, dim))\n","        self.biases = nn.Parameter(torch.randn(num_numerical_types, dim))\n","\n","    def forward(self, x):\n","        x = rearrange(x, 'b n -> b n 1')\n","        return x * self.weights + self.biases\n","\n","\n","class NumericMLP(nn.Module):\n","    def __init__(self, num_numeric_features, dim, hidden_dims=[64, 64]):\n","        super().__init__()\n","        layers = []\n","        input_dim = num_numeric_features\n","        for h_dim in hidden_dims:\n","            layers.append(nn.Linear(input_dim, h_dim))\n","            layers.append(nn.BatchNorm1d(h_dim))   # <-- Add this\n","            layers.append(nn.ReLU())\n","            layers.append(nn.Dropout(0.1))         # <-- Add this\n","            input_dim = h_dim\n","        layers.append(nn.Linear(input_dim, dim))\n","        self.mlp = nn.Sequential(*layers)\n","\n","    def forward(self, x):\n","        return self.mlp(x)\n","\n","class FTTransformerFusion(nn.Module):\n","    def __init__(\n","        self,\n","        *,\n","        categories,\n","        num_continuous,\n","        dim,\n","        depth,\n","        heads,\n","        dim_head=16,\n","        dim_out=1,\n","        num_special_tokens=2,\n","        attn_dropout=0.,\n","        ff_dropout=0.,\n","        mlp_hidden_dims=[64, 64]\n","    ):\n","        super().__init__()\n","        assert all(map(lambda n: n > 0, categories)), 'number of each category must be positive'\n","        assert len(categories) + num_continuous > 0, 'input shape must not be null'\n","\n","        # Categories setup\n","        self.num_categories = len(categories)\n","        self.num_unique_categories = sum(categories)\n","        self.num_special_tokens = num_special_tokens\n","        total_tokens = self.num_unique_categories + num_special_tokens\n","\n","        if self.num_unique_categories > 0:\n","            categories_offset = F.pad(torch.tensor(list(categories)), (1, 0), value=num_special_tokens)\n","            categories_offset = categories_offset.cumsum(dim=-1)[:-1]\n","            self.register_buffer('categories_offset', categories_offset)\n","            self.categorical_embeds = nn.Embedding(total_tokens, dim)\n","\n","        # Specialized numeric MLP for numerical features\n","        self.num_continuous = num_continuous\n","        if self.num_continuous > 0:\n","            self.numeric_mlp = NumericMLP(num_continuous, dim, mlp_hidden_dims)\n","\n","        # CLS token for transformer\n","        self.cls_token = nn.Parameter(torch.randn(1, 1, dim))\n","\n","        # Transformer blocks\n","        self.transformer = Transformer(\n","            dim=dim,\n","            depth=depth,\n","            heads=heads,\n","            dim_head=dim_head,\n","            attn_dropout=attn_dropout,\n","            ff_dropout=ff_dropout\n","        )\n","\n","        # Final output head\n","        self.to_logits = nn.Sequential(\n","            nn.LayerNorm(dim),\n","            nn.ReLU(),\n","            nn.Linear(dim, dim_out)\n","        )\n","\n","    def forward(self, x_categ, x_numer, return_attn=False):\n","      xs = []\n","      num_residual = None\n","\n","      if self.num_unique_categories > 0:\n","          x_categ = x_categ + self.categories_offset\n","          x_categ = self.categorical_embeds(x_categ)\n","          xs.append(x_categ)\n","\n","      if self.num_continuous > 0:\n","          x_numer_emb = self.numeric_mlp(x_numer)\n","          num_residual = x_numer_emb  # keep original dense numeric representation\n","          x_numer_emb = x_numer_emb.unsqueeze(1)\n","          xs.append(x_numer_emb)\n","\n","      x = torch.cat(xs, dim=1)\n","      b = x.shape[0]\n","      cls_tokens = repeat(self.cls_token, '1 1 d -> b 1 d', b=b)\n","      x = torch.cat((cls_tokens, x), dim=1)\n","\n","      x, attns = self.transformer(x, return_attn=True)\n","      x = x[:, 0]\n","\n","      # ðŸ”¥ Fuse transformer CLS with raw numeric signal\n","      if num_residual is not None:\n","          x = x + 0.2 * num_residual  # small residual connection (learns anomaly-aware balance)\n","\n","      logits = self.to_logits(x)\n","\n","      if not return_attn:\n","          return logits\n","      return logits, attns\n"]},{"cell_type":"markdown","metadata":{"id":"GQbua9hnyb3t"},"source":["======================================================================="]},{"cell_type":"code","source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")"],"metadata":{"id":"xw2OxaMb9nHI","executionInfo":{"status":"ok","timestamp":1760961462139,"user_tz":-480,"elapsed":4,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":40,"outputs":[]},{"cell_type":"code","execution_count":41,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1760961463784,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"GP2nhw8Hx73H"},"outputs":[],"source":["model = FTTransformerFusion(\n","    categories=cat_dims,                                   # list of number of classes for each categorical column\n","    num_continuous=len(features) - len(cat_dims),          # number of numerical features\n","    dim=32,                                                # embedding dimension per token\n","    depth=6,                                               # number of Transformer layers\n","    heads=8,                                               # number of attention heads\n","    dim_head=16,                                           # dimension per attention head (optional)\n","    dim_out=1,                                             # output dimension (e.g., 2 for binary classification)\n","    attn_dropout=0.1,\n","    ff_dropout=0.1,\n","    num_special_tokens=2,                                  # CLS + optional others (e.g., MASK)\n","    mlp_hidden_dims=[64, 64]                               # hidden sizes for numeric MLP\n",").to(device)"]},{"cell_type":"code","source":["import torch\n","import torch.nn.functional as F\n","from torch import nn\n","\n","class FocalLoss(nn.Module):\n","    \"\"\"\n","    Focal Loss for binary classification.\n","    Helps models focus on hard, minority examples.\n","    \"\"\"\n","    def __init__(self, alpha=5.0, gamma=2.0, reduction='mean'):\n","        super().__init__()\n","        self.alpha = alpha\n","        self.gamma = gamma\n","        self.reduction = reduction\n","\n","    def forward(self, logits, targets):\n","        \"\"\"\n","        logits: (batch,) or (batch, 1) raw model outputs\n","        targets: (batch,) binary labels 0 or 1\n","        \"\"\"\n","        targets = targets.float().view(-1, 1)\n","        logits = logits.view(-1, 1)\n","\n","        bce_loss = F.binary_cross_entropy_with_logits(logits, targets, reduction='none')\n","        pt = torch.exp(-bce_loss)  # probability of the correct class\n","        focal_term = self.alpha * (1 - pt) ** self.gamma * bce_loss\n","\n","        if self.reduction == 'mean':\n","            return focal_term.mean()\n","        elif self.reduction == 'sum':\n","            return focal_term.sum()\n","        return focal_term"],"metadata":{"id":"ENC6o4HZTGAU","executionInfo":{"status":"ok","timestamp":1760961473863,"user_tz":-480,"elapsed":4,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":42,"outputs":[]},{"cell_type":"code","execution_count":43,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OquETEtzzZ-V","executionInfo":{"status":"ok","timestamp":1760962441803,"user_tz":-480,"elapsed":961634,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"9bbac7a6-bd2e-4b09-c52d-ce196bf49d7b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 01 | Loss=0.0330 | Val F1=0.6372 | Thr=0.47\n","Epoch 02 | Loss=0.0084 | Val F1=0.6829 | Thr=0.47\n","Epoch 03 | Loss=0.0072 | Val F1=0.7200 | Thr=0.11\n","Epoch 04 | Loss=0.0074 | Val F1=0.7460 | Thr=0.19\n","Epoch 05 | Loss=0.0083 | Val F1=0.7000 | Thr=0.13\n","Epoch 06 | Loss=0.0071 | Val F1=0.7419 | Thr=0.10\n","Epoch 07 | Loss=0.0064 | Val F1=0.7500 | Thr=0.08\n","Epoch 08 | Loss=0.0069 | Val F1=0.7288 | Thr=0.16\n","Epoch 09 | Loss=0.0077 | Val F1=0.7500 | Thr=0.05\n","Epoch 10 | Loss=0.0073 | Val F1=0.7500 | Thr=0.08\n","Epoch 11 | Loss=0.0066 | Val F1=0.7500 | Thr=0.14\n","Epoch 12 | Loss=0.0068 | Val F1=0.7500 | Thr=0.14\n","Epoch 13 | Loss=0.0061 | Val F1=0.7500 | Thr=0.13\n","Epoch 14 | Loss=0.0062 | Val F1=0.7500 | Thr=0.08\n","Epoch 15 | Loss=0.0062 | Val F1=0.7559 | Thr=0.27\n","Epoch 16 | Loss=0.0056 | Val F1=0.7500 | Thr=0.25\n","Epoch 17 | Loss=0.0051 | Val F1=0.7500 | Thr=0.25\n","Epoch 18 | Loss=0.0049 | Val F1=0.7500 | Thr=0.36\n","Epoch 19 | Loss=0.0048 | Val F1=0.7500 | Thr=0.21\n","Epoch 20 | Loss=0.0048 | Val F1=0.7500 | Thr=0.30\n","Best Validation F1: 0.7559\n"]}],"source":["# --- Optimizer + Scheduler ---\n","optimizer = torch.optim.AdamW(model.parameters(), lr=1e-3, weight_decay=1e-2)\n","scheduler = torch.optim.lr_scheduler.OneCycleLR(\n","    optimizer, max_lr=1e-3, steps_per_epoch=len(train_loader), epochs=20\n",")\n","\n","# --- Loss Function ---\n","criterion = FocalLoss(alpha=5.0, gamma=2.0)\n","\n","# --- Training ---\n","best_val_f1, best_model_state = 0.0, None\n","\n","for epoch in range(20):\n","    model.train()\n","    total_loss = 0\n","\n","    for x_cat, x_num, y in train_loader:\n","        x_cat, x_num, y = x_cat.to(device), x_num.to(device), y.to(device)\n","        optimizer.zero_grad()\n","        logits = model(x_cat, x_num)\n","        loss = criterion(logits, y)\n","        loss.backward()\n","        optimizer.step()\n","        scheduler.step()\n","        total_loss += loss.item()\n","\n","    # Validation\n","    model.eval()\n","    preds, labels = [], []\n","    with torch.no_grad():\n","        for x_cat, x_num, y in valid_loader:\n","            x_cat, x_num = x_cat.to(device), x_num.to(device)\n","            logits = model(x_cat, x_num)\n","            probs = torch.sigmoid(logits).cpu().numpy().flatten()\n","            preds.extend(probs)\n","            labels.extend(y.numpy())\n","\n","    # Tune threshold for F1\n","    thresholds = np.linspace(0.05, 0.5, 30)\n","    f1s = [f1_score(labels, (np.array(preds) > t).astype(int)) for t in thresholds]\n","    best_t = thresholds[np.argmax(f1s)]\n","    val_f1 = max(f1s)\n","\n","    if val_f1 > best_val_f1:\n","        best_val_f1 = val_f1\n","        best_model_state = model.state_dict()\n","\n","    print(f\"Epoch {epoch+1:02d} | Loss={total_loss/len(train_loader):.4f} | Val F1={val_f1:.4f} | Thr={best_t:.2f}\")\n","\n","# --- Save best model ---\n","model.load_state_dict(best_model_state)\n","print(f\"Best Validation F1: {best_val_f1:.4f}\")"]},{"cell_type":"code","source":["print(test_df[target].value_counts())\n","print(\"\\nAnomaly ratio:\", test_df[target].mean())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1oYHYVtui09U","executionInfo":{"status":"ok","timestamp":1760962784393,"user_tz":-480,"elapsed":9,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"c457b5a8-8a20-4cbc-969a-afc0762e922f"},"execution_count":44,"outputs":[{"output_type":"stream","name":"stdout","text":["Class\n","0    28432\n","1       49\n","Name: count, dtype: int64\n","\n","Anomaly ratio: 0.0017204452090867595\n"]}]},{"cell_type":"code","execution_count":45,"metadata":{"id":"0_u9H5FB55j0","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1760962792305,"user_tz":-480,"elapsed":4678,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"e14d02fd-731e-45c0-d3b6-b23e29b69494"},"outputs":[{"output_type":"stream","name":"stdout","text":["Preds: 28481 Labels: 28481\n","Test F1: 0.8080808080808081\n"]}],"source":["# 5ï¸âƒ£ Final test evaluation\n","model.eval()\n","test_probs = []\n","\n","with torch.no_grad():\n","    for x_categ, x_cont, _ in test_loader:\n","        x_categ = x_categ.to(device)\n","        x_cont = x_cont.to(device)\n","        logits = model(x_cat, x_cont)\n","        test_probs.extend(torch.sigmoid(logits).cpu().numpy().flatten())\n","\n","# Ensure same length as y_test\n","print(\"Preds:\", len(test_probs), \"Labels:\", len(y_test))\n","\n","# F1 computation\n","y_pred = (np.array(test_probs) > best_t).astype(int)\n","test_f1 = f1_score(y_test, y_pred)\n","print(\"Test F1:\", test_f1)"]},{"cell_type":"code","execution_count":46,"metadata":{"id":"zGZ9KqXK0AiS","colab":{"base_uri":"https://localhost:8080/","height":472},"executionInfo":{"status":"ok","timestamp":1760962794996,"user_tz":-480,"elapsed":188,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"23d46a56-1a46-4769-8239-e958c3e5df58"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAgwAAAHHCAYAAADTQQDlAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAARw5JREFUeJzt3Xd8FNX+//H3JpBNgBRqQiSGpkAEQYoxIu0aCVIE0asUNfSLggKRIhaahe9FqaJgJegFBQsooGgEAZFYACNF4FKioJCAIFkSSCGZ3x/c7M814GaZDQnM68ljHtc9c2bmM3sx+fg558zYDMMwBAAA8Dd8SjsAAABQ9pEwAAAAt0gYAACAWyQMAADALRIGAADgFgkDAABwi4QBAAC4RcIAAADcImEAAABukTAAf7F371517NhRwcHBstlsWr58uVfP//PPP8tmsykxMdGr572ctW/fXu3bty/tMAD8DRIGlEn79+/Xv/71L9WtW1f+/v4KCgpS69atNXv2bJ05c6ZErx0fH6/t27fr2Wef1dtvv62WLVuW6PUupX79+slmsykoKOi83+PevXtls9lks9n0wgsveHz+w4cPa9KkSUpJSfFCtADKknKlHQDwV6tWrdI///lP2e12PfDAA2rcuLFyc3O1ceNGjRkzRjt37tSrr75aItc+c+aMkpOT9cQTT2j48OElco3IyEidOXNG5cuXL5Hzu1OuXDmdPn1aK1as0D333OOyb9GiRfL391d2dvZFnfvw4cOaPHmyateurWbNmhX7uM8///yirgfg0iFhQJmSmpqqXr16KTIyUmvXrlXNmjWd+4YNG6Z9+/Zp1apVJXb9Y8eOSZJCQkJK7Bo2m03+/v4ldn537Ha7WrdurXfeeadIwrB48WJ16dJFH3zwwSWJ5fTp06pQoYL8/PwuyfUAXDyGJFCmTJs2TZmZmXrjjTdckoVC9evX14gRI5yfz549q6efflr16tWT3W5X7dq19fjjjysnJ8fluNq1a6tr167auHGjbrzxRvn7+6tu3bp66623nH0mTZqkyMhISdKYMWNks9lUu3ZtSedK+YX//GeTJk2SzWZzaUtKStItt9yikJAQVapUSQ0aNNDjjz/u3H+hOQxr165VmzZtVLFiRYWEhKh79+7atWvXea+3b98+9evXTyEhIQoODlb//v11+vTpC3+xf9GnTx99+umnOnnypLPt+++/1969e9WnT58i/U+cOKHRo0erSZMmqlSpkoKCgnT77bfrxx9/dPZZt26dWrVqJUnq37+/c2ij8D7bt2+vxo0ba8uWLWrbtq0qVKjg/F7+OochPj5e/v7+Re4/Li5OlStX1uHDh4t9rwC8g4QBZcqKFStUt25d3XzzzcXqP2jQIE2YMEHNmzfXzJkz1a5dO02dOlW9evUq0nffvn26++67ddttt2n69OmqXLmy+vXrp507d0qSevbsqZkzZ0qSevfurbfffluzZs3yKP6dO3eqa9euysnJ0ZQpUzR9+nTdcccd+vrrr//2uC+++EJxcXE6evSoJk2apISEBG3atEmtW7fWzz//XKT/Pffco1OnTmnq1Km65557lJiYqMmTJxc7zp49e8pms+nDDz90ti1evFgNGzZU8+bNi/Q/cOCAli9frq5du2rGjBkaM2aMtm/frnbt2jl/eTdq1EhTpkyRJA0ZMkRvv/223n77bbVt29Z5nuPHj+v2229Xs2bNNGvWLHXo0OG88c2ePVvVq1dXfHy88vPzJUmvvPKKPv/8c7344osKDw8v9r0C8BIDKCMyMjIMSUb37t2L1T8lJcWQZAwaNMilffTo0YYkY+3atc62yMhIQ5KxYcMGZ9vRo0cNu91uPProo8621NRUQ5Lx/PPPu5wzPj7eiIyMLBLDxIkTjT//azRz5kxDknHs2LELxl14jQULFjjbmjVrZtSoUcM4fvy4s+3HH380fHx8jAceeKDI9QYMGOByzjvvvNOoWrXqBa/55/uoWLGiYRiGcffddxu33nqrYRiGkZ+fb4SFhRmTJ08+73eQnZ1t5OfnF7kPu91uTJkyxdn2/fffF7m3Qu3atTMkGfPnzz/vvnbt2rm0ffbZZ4Yk45lnnjEOHDhgVKpUyejRo4fbewRQMqgwoMxwOBySpMDAwGL1/+STTyRJCQkJLu2PPvqoJBWZ6xAVFaU2bdo4P1evXl0NGjTQgQMHLjrmvyqc+/DRRx+poKCgWMccOXJEKSkp6tevn6pUqeJsv/7663Xbbbc57/PPhg4d6vK5TZs2On78uPM7LI4+ffpo3bp1SktL09q1a5WWlnbe4Qjp3LwHH59zPy7y8/N1/Phx53DL1q1bi31Nu92u/v37F6tvx44d9a9//UtTpkxRz5495e/vr1deeaXY1wLgXSQMKDOCgoIkSadOnSpW/19++UU+Pj6qX7++S3tYWJhCQkL0yy+/uLRfffXVRc5RuXJl/fHHHxcZcVH33nuvWrdurUGDBik0NFS9evXS0qVL/zZ5KIyzQYMGRfY1atRIv//+u7Kyslza/3ovlStXliSP7qVz584KDAzUkiVLtGjRIrVq1arId1mooKBAM2fO1DXXXCO73a5q1aqpevXq2rZtmzIyMop9zauuusqjCY4vvPCCqlSpopSUFM2ZM0c1atQo9rEAvIuEAWVGUFCQwsPDtWPHDo+O++ukwwvx9fU9b7thGBd9jcLx9UIBAQHasGGDvvjiC91///3atm2b7r33Xt12221F+pph5l4K2e129ezZUwsXLtSyZcsuWF2QpOeee04JCQlq27at/vOf/+izzz5TUlKSrrvuumJXUqRz348nfvjhBx09elSStH37do+OBeBdJAwoU7p27ar9+/crOTnZbd/IyEgVFBRo7969Lu3p6ek6efKkc8WDN1SuXNllRUGhv1YxJMnHx0e33nqrZsyYoZ9++knPPvus1q5dqy+//PK85y6Mc8+ePUX27d69W9WqVVPFihXN3cAF9OnTRz/88INOnTp13omihd5//3116NBBb7zxhnr16qWOHTsqNja2yHdS3OStOLKystS/f39FRUVpyJAhmjZtmr7//nuvnR+AZ0gYUKaMHTtWFStW1KBBg5Senl5k//79+zV79mxJ50rqkoqsZJgxY4YkqUuXLl6Lq169esrIyNC2bducbUeOHNGyZctc+p04caLIsYUPMPrrUs9CNWvWVLNmzbRw4UKXX8A7duzQ559/7rzPktChQwc9/fTTmjt3rsLCwi7Yz9fXt0j14r333tNvv/3m0laY2JwvufLUuHHjdPDgQS1cuFAzZsxQ7dq1FR8ff8HvEUDJ4sFNKFPq1aunxYsX695771WjRo1cnvS4adMmvffee+rXr58kqWnTpoqPj9err76qkydPql27dvruu++0cOFC9ejR44JL9i5Gr169NG7cON1555165JFHdPr0ac2bN0/XXnuty6S/KVOmaMOGDerSpYsiIyN19OhRvfzyy6pVq5ZuueWWC57/+eef1+23366YmBgNHDhQZ86c0Ysvvqjg4GBNmjTJa/fxVz4+PnryySfd9uvataumTJmi/v376+abb9b27du1aNEi1a1b16Vf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\n"},"metadata":{}}],"source":["# Confusion Matrix\n","cm = confusion_matrix(y_test, y_pred)\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm)\n","disp.plot(cmap=plt.cm.Blues)\n","plt.title(\"Confusion Matrix\")\n","plt.show()"]},{"cell_type":"code","source":["# Accuracy, Precision, Recall, F1-Score\n","accuracy = accuracy_score(y_test, y_pred)\n","precision = precision_score(y_test, y_pred)\n","recall = recall_score(y_test, y_pred)\n","f1 = f1_score(y_test, y_pred)\n","auc = roc_auc_score(y_test, y_pred)\n","\n","\n","# Print individual scores\n","print(f\"Accuracy: {accuracy:.4f}\")\n","print(f\"Precision: {precision:.4f}\")\n","print(f\"Recall: {recall:.4f}\")\n","print(f\"F1-Score: {f1:.4f}\")\n","print(f\"ROC-AUC: {auc:.4f}\")\n","\n","# Classification report for a detailed overview\n","print(classification_report(y_test, y_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VhO2p17A9x-K","executionInfo":{"status":"ok","timestamp":1760962798824,"user_tz":-480,"elapsed":27,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"7a6ab05d-e545-49c5-9a25-c23a809f62c8"},"execution_count":47,"outputs":[{"output_type":"stream","name":"stdout","text":["Accuracy: 0.9993\n","Precision: 0.8000\n","Recall: 0.8163\n","F1-Score: 0.8081\n","ROC-AUC: 0.9080\n","              precision    recall  f1-score   support\n","\n","           0       1.00      1.00      1.00     28432\n","           1       0.80      0.82      0.81        49\n","\n","    accuracy                           1.00     28481\n","   macro avg       0.90      0.91      0.90     28481\n","weighted avg       1.00      1.00      1.00     28481\n","\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"iogJ7zeoAorG"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"gpuType":"T4","authorship_tag":"ABX9TyOph3mteQnMU4wwPzMnfqB/"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}