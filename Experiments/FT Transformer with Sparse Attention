{"cells":[{"cell_type":"code","execution_count":24,"metadata":{"executionInfo":{"elapsed":31,"status":"ok","timestamp":1760889073387,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"QYO-HYkgZ4T3"},"outputs":[],"source":["import torch\n","import torch.nn as nn\n","import pandas as pd\n","import numpy as np\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.metrics import accuracy_score\n","from torch.utils.data import DataLoader, TensorDataset\n","from torch.optim import Adam\n","from sklearn.model_selection import train_test_split\n","import matplotlib.pyplot as plt"]},{"cell_type":"code","execution_count":25,"metadata":{"id":"VdpcwaM9z4TN","executionInfo":{"status":"ok","timestamp":1760889073399,"user_tz":-480,"elapsed":4,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"outputs":[],"source":["from sklearn.metrics import accuracy_score, confusion_matrix, ConfusionMatrixDisplay\n","from sklearn.metrics import precision_score, recall_score, f1_score, classification_report\n","from sklearn.metrics import roc_auc_score, precision_recall_curve, f1_score"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2579,"status":"ok","timestamp":1760889077010,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"7lEomYw8aQbh","outputId":"b11c173a-e0df-4d64-ca27-c1c6f6ae9074"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"5Q9MHkvXys9q"},"source":["=====================Data prepration============================="]},{"cell_type":"code","execution_count":27,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1760889077015,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"JEb6Fm_HcbCy"},"outputs":[],"source":["# -----------------\n","# Helper: stratified sampling\n","# -----------------\n","def stratified_sample(df, target_col, frac=None, n=None, random_state=42):\n","    \"\"\"Return stratified sample keeping target ratio\"\"\"\n","    if frac is not None:\n","        df_sampled = df.groupby(target_col, group_keys=False)\\\n","                       .apply(lambda x: x.sample(frac=frac, random_state=random_state))\n","    elif n is not None:\n","        class_counts = df[target_col].value_counts()\n","        total = class_counts.sum()\n","        df_sampled = []\n","        for c, count in class_counts.items():\n","            take = int(n * (count / total))\n","            df_sampled.append(df[df[target_col] == c].sample(n=take, random_state=random_state))\n","        df_sampled = pd.concat(df_sampled)\n","    else:\n","        df_sampled = df\n","    return df_sampled.sample(frac=1.0, random_state=random_state).reset_index(drop=True)"]},{"cell_type":"code","source":["dataset = \"B\"\n","\n","if dataset == \"A\":\n","  dataset_name = \"/content/drive/MyDrive/wustl_iiot_2021.csv\"\n","  target = 'Target'\n","  drop_cols = [\"StartTime\", \"LastTime\", \"Traffic\", \"SrcAddr\", \"DstAddr\"]\n","  frac=0.1\n","elif dataset == \"B\":\n","  dataset_name = \"/content/drive/MyDrive/creditcard.csv\"\n","  target = 'Class'\n","  drop_cols = [\"Time\"]\n","  frac=0.5"],"metadata":{"id":"zNLyODO3h4nL","executionInfo":{"status":"ok","timestamp":1760889083270,"user_tz":-480,"elapsed":3,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6663,"status":"ok","timestamp":1760889093748,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"tqQUooD0aAPH","outputId":"5ff84525-dfd7-43b3-bff3-5f5618dfcc00"},"outputs":[{"output_type":"stream","name":"stdout","text":["Original dataset shape: (284807, 30), anomaly ratio=0.1727%\n","Sampled dataset shape: (142404, 30), anomaly ratio=0.1727%\n"]},{"output_type":"stream","name":"stderr","text":["/tmp/ipython-input-2184620091.py:8: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.\n","  .apply(lambda x: x.sample(frac=frac, random_state=random_state))\n"]},{"output_type":"stream","name":"stdout","text":["Train shape: (75948, 30), anomaly ratio=0.1725%\n","Valid shape: (37975, 30), anomaly ratio=0.1738%\n","Test shape:  (28481, 30),  anomaly ratio=0.1720%\n","['V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'Amount']\n","Categorical columns: []\n","Numerical columns: ['V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'Amount']\n","[]\n","[]\n"]}],"source":["df = pd.read_csv(dataset_name)\n","\n","df = df.drop(columns=[c for c in drop_cols if c in df.columns])\n","\n","print(f\"Original dataset shape: {df.shape}, anomaly ratio={df[target].mean():.4%}\")\n","\n","# Stratified sampling\n","df_sampled = stratified_sample(df, target, frac=frac, random_state=0)\n","print(f\"Sampled dataset shape: {df_sampled.shape}, anomaly ratio={df_sampled[target].mean():.4%}\")\n","\n","df_sampled = df_sampled.reset_index(drop=True)\n","\n","features = df_sampled.columns\n","\n","train_df, test_df = train_test_split(\n","    df_sampled, test_size=0.2, stratify=df_sampled[target], random_state=0\n",")\n","\n","train_df, valid_df = train_test_split(\n","    train_df, test_size= 0.2 / 0.6, stratify=train_df[target], random_state=0\n",")\n","\n","print(f\"Train shape: {train_df.shape}, anomaly ratio={train_df[target].mean():.4%}\")\n","print(f\"Valid shape: {valid_df.shape}, anomaly ratio={valid_df[target].mean():.4%}\")\n","print(f\"Test shape:  {test_df.shape},  anomaly ratio={test_df[target].mean():.4%}\")\n","\n","# Add the \"Set\" column\n","train_df[\"Set\"] = \"train\"\n","valid_df[\"Set\"] = \"valid\"\n","test_df[\"Set\"] = \"test\"\n","\n","# Combine them back together\n","train = pd.concat([train_df, valid_df, test_df]).reset_index(drop=True)\n","\n","train_indices = train[train.Set == \"train\"].index\n","valid_indices = train[train.Set == \"valid\"].index\n","test_indices = train[train.Set == \"test\"].index\n","\n","\n","categorical_columns = []\n","numerical_columns = []\n","categorical_dims = {}\n","\n","nunique = train.nunique()\n","types = train.dtypes\n","\n","for col in train.columns:\n","    if col == target or col == 'Set':\n","        continue\n","    if types[col] == 'object':\n","        l_enc = LabelEncoder()\n","        train[col] = train[col].fillna(\"VV_likely\")\n","        train[col] = l_enc.fit_transform(train[col].values)\n","        categorical_columns.append(col)\n","        categorical_dims[col] = len(l_enc.classes_)\n","    else:\n","        train.fillna(train.loc[train_indices, col].mean(), inplace=True)\n","        numerical_columns.append(col)\n","\n","unused_feat = [\"Set\"]\n","\n","features = [col for col in df_sampled.columns if col not in unused_feat + [target]]\n","\n","print(features)\n","print(\"Categorical columns:\", categorical_columns)\n","print(\"Numerical columns:\", numerical_columns)\n","\n","cat_idxs = [i for i, f in enumerate(features) if f in categorical_columns]\n","\n","print(cat_idxs)\n","cat_dims = [categorical_dims[f] for i, f in enumerate(features) if f in categorical_columns]\n","print(cat_dims)"]},{"cell_type":"code","execution_count":30,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1760889096616,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"c-yxDUQHxt6F"},"outputs":[],"source":["target_enc = LabelEncoder()\n","train[target] = target_enc.fit_transform(train[target].values)"]},{"cell_type":"code","execution_count":31,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1760889098246,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"oXFTqW5IblTA"},"outputs":[],"source":["X_train = train[features].values[train_indices]\n","y_train = train[target].values[train_indices]\n","\n","X_valid = train[features].values[valid_indices]\n","y_valid = train[target].values[valid_indices]\n","\n","X_test = train[features].values[test_indices]\n","y_test = train[target].values[test_indices]"]},{"cell_type":"code","source":["X_train[:2]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lrzMwFTWTTB8","executionInfo":{"status":"ok","timestamp":1760889100112,"user_tz":-480,"elapsed":5,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"e1fc40de-ebd1-4173-f471-5236be93ccd1"},"execution_count":32,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-1.19197911e+00,  3.65650122e-01, -8.51445584e-01,\n","        -5.55876464e-02,  6.60455094e-01, -8.97987761e-01,\n","         9.17589518e-01, -1.09320231e+00, -3.04718385e-03,\n","        -3.14985028e-01,  1.37842811e+00,  5.80745705e-01,\n","         4.10150716e-02, -7.67188541e-01,  1.12237566e-01,\n","         2.29330820e-01,  2.57217208e-01,  1.05117226e+00,\n","         7.67926875e-02, -6.39738004e-01,  9.28457312e-01,\n","         1.00805213e+00,  5.59219071e-01, -4.87668841e-02,\n","        -1.88406839e-01, -1.33895716e-01,  3.85090717e-01,\n","         1.49271649e-01,  9.90000000e+01],\n","       [-1.10183428e+00,  1.42811407e+00,  1.75677727e+00,\n","         4.57016384e+00, -7.85317014e-01,  1.74108541e+00,\n","         4.60257243e-01,  4.84929055e-01, -7.22077270e-01,\n","         6.13497785e-01, -4.18485976e-01, -3.65065122e+00,\n","         1.53242701e+00,  1.78262993e+00,  7.01455562e-01,\n","         5.11940272e-01,  8.11029639e-01,  1.08387676e+00,\n","         7.74394808e-01,  1.48712822e-01,  1.01479933e-01,\n","         3.42363325e-01, -1.18869258e-01,  6.43704638e-01,\n","         1.74076932e-01,  4.92296165e-01, -9.15912795e-02,\n","        -2.42055297e-02,  2.26440000e+02]])"]},"metadata":{},"execution_count":32}]},{"cell_type":"code","source":["y_train[:2]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6ZaXye2RTUKI","executionInfo":{"status":"ok","timestamp":1760889102591,"user_tz":-480,"elapsed":15,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"c77b1ebd-1af1-49d4-ec3d-396b71d4eb3d"},"execution_count":33,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0])"]},"metadata":{},"execution_count":33}]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":25,"status":"ok","timestamp":1760889104676,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"XEizQZmXgxQm"},"outputs":[],"source":["# Split the data into categorical and continuous parts\n","X_train_categ = torch.tensor(X_train[:, cat_idxs], dtype=torch.long)\n","X_train_cont = torch.tensor(np.delete(X_train, cat_idxs, axis=1), dtype=torch.float32)\n","y_train_tensor = torch.tensor(y_train, dtype=torch.long)\n","\n","X_valid_categ = torch.tensor(X_valid[:, cat_idxs], dtype=torch.long)\n","X_valid_cont = torch.tensor(np.delete(X_valid, cat_idxs, axis=1), dtype=torch.float32)\n","y_valid_tensor = torch.tensor(y_valid, dtype=torch.long)\n","\n","X_test_categ = torch.tensor(X_test[:, cat_idxs], dtype=torch.long)\n","X_test_cont = torch.tensor(np.delete(X_test, cat_idxs, axis=1), dtype=torch.float32)\n","y_test_tensor = torch.tensor(y_test, dtype=torch.long)\n","\n","# Create DataLoaders\n","train_dataset = TensorDataset(X_train_categ, X_train_cont, y_train_tensor)\n","train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)\n","\n","valid_dataset = TensorDataset(X_valid_categ, X_valid_cont, y_valid_tensor)\n","valid_loader = DataLoader(valid_dataset, batch_size=32, shuffle=False)\n","\n","test_dataset = TensorDataset(X_test_categ, X_test_cont, y_test_tensor)\n","test_loader = DataLoader(test_dataset, batch_size=32, shuffle=False)"]},{"cell_type":"markdown","metadata":{"id":"6t0AMSr8y2Pe"},"source":["======================================================================"]},{"cell_type":"markdown","metadata":{"id":"Lbv9mESCyQNX"},"source":["==================================Model================================"]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1760889106012,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"t9qv3vmlzpQx"},"outputs":[],"source":["import torch\n","import torch.nn.functional as F\n","from torch import nn, einsum\n","\n","from einops import rearrange"]},{"cell_type":"code","execution_count":45,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1760890029274,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"5UmJ2xwyy-AA"},"outputs":[],"source":["import torch\n","import torch.nn.functional as F\n","from torch import nn, einsum\n","from einops import rearrange, repeat\n","\n","# -------------------------\n","# Feedforward\n","# -------------------------\n","\n","class GEGLU(nn.Module):\n","    def forward(self, x):\n","        x, gates = x.chunk(2, dim=-1)\n","        return x * F.gelu(gates)\n","\n","def FeedForward(dim, mult=4, dropout=0.):\n","    return nn.Sequential(\n","        nn.LayerNorm(dim),\n","        nn.Linear(dim, dim * mult * 2),\n","        GEGLU(),\n","        nn.Dropout(dropout),\n","        nn.Linear(dim * mult, dim)\n","    )\n","\n","# -------------------------\n","# Sparse Attention (Top-k)\n","# -------------------------\n","\n","class SparseAttention(nn.Module):\n","    def __init__(self, dim, heads=8, dim_head=64, dropout=0., sparse_topk=16):\n","        super().__init__()\n","        inner_dim = dim_head * heads\n","        self.heads = heads\n","        self.scale = dim_head ** -0.5\n","        self.sparse_topk = sparse_topk\n","\n","        self.norm = nn.LayerNorm(dim)\n","        self.to_qkv = nn.Linear(dim, inner_dim * 3, bias=False)\n","        self.to_out = nn.Linear(inner_dim, dim, bias=False)\n","        self.dropout = nn.Dropout(dropout)\n","\n","    def forward(self, x):\n","        h = self.heads\n","        x = self.norm(x)\n","        q, k, v = self.to_qkv(x).chunk(3, dim=-1)\n","        q, k, v = map(lambda t: rearrange(t, 'b n (h d) -> b h n d', h=h), (q, k, v))\n","        q = q * self.scale\n","\n","        sim = einsum('b h i d, b h j d -> b h i j', q, k)\n","\n","        # sparse attention: top-k keys per query\n","        if self.sparse_topk is not None and self.sparse_topk < sim.size(-1):\n","            topk_vals, topk_idx = sim.topk(self.sparse_topk, dim=-1)\n","            mask = torch.zeros_like(sim, dtype=torch.bool)\n","            mask.scatter_(-1, topk_idx, True)\n","            sim = sim.masked_fill(~mask, float('-inf'))\n","\n","        attn = sim.softmax(dim=-1)\n","        dropped_attn = self.dropout(attn)\n","\n","        out = einsum('b h i j, b h j d -> b h i d', dropped_attn, v)\n","        out = rearrange(out, 'b h n d -> b n (h d)', h=h)\n","        return self.to_out(out), attn\n","\n","# -------------------------\n","# Transformer Block\n","# -------------------------\n","\n","class Transformer(nn.Module):\n","    def __init__(self, dim, depth, heads, dim_head, attn_dropout, ff_dropout, sparse_topk):\n","        super().__init__()\n","        self.layers = nn.ModuleList([\n","            nn.ModuleList([\n","                SparseAttention(dim, heads=heads, dim_head=dim_head, dropout=attn_dropout, sparse_topk=sparse_topk),\n","                FeedForward(dim, dropout=ff_dropout)\n","            ])\n","            for _ in range(depth)\n","        ])\n","\n","    def forward(self, x, return_attn=False):\n","        attns = []\n","        for attn, ff in self.layers:\n","            attn_out, attn_weights = attn(x)\n","            x = x + attn_out\n","            x = x + ff(x)\n","            attns.append(attn_weights)\n","        return (x, torch.stack(attns)) if return_attn else x\n","\n","# -------------------------\n","# Numerical Embedder\n","# -------------------------\n","\n","class NumericalEmbedder(nn.Module):\n","    def __init__(self, dim, num_features):\n","        super().__init__()\n","        self.weights = nn.Parameter(torch.randn(num_features, dim))\n","        self.biases = nn.Parameter(torch.randn(num_features, dim))\n","\n","    def forward(self, x):\n","        return rearrange(x, 'b n -> b n 1') * self.weights + self.biases\n","\n","# -------------------------\n","# FTTransformer for Tabular Data\n","# -------------------------\n","\n","class FTTransformer(nn.Module):\n","    def __init__(\n","        self,\n","        categories,\n","        num_continuous,\n","        dim,\n","        depth,\n","        heads,\n","        dim_head=16,\n","        dim_out=1,\n","        attn_dropout=0.,\n","        ff_dropout=0.,\n","        sparse_topk=16\n","    ):\n","        super().__init__()\n","        assert all(c > 0 for c in categories), 'Category sizes must be positive'\n","\n","        # embeddings\n","        self.num_categories = len(categories)\n","        self.num_continuous = num_continuous\n","        self.num_unique_categories = sum(categories)\n","\n","        if self.num_categories > 0:\n","            offsets = F.pad(torch.tensor(categories), (1, 0), value=2).cumsum(0)[:-1]\n","            self.register_buffer('categories_offset', offsets)\n","            self.categorical_embeds = nn.Embedding(self.num_unique_categories + 2, dim)\n","\n","        if num_continuous > 0:\n","            self.numerical_embedder = NumericalEmbedder(dim, num_continuous)\n","\n","        # cls token\n","        self.cls_token = nn.Parameter(torch.randn(1, 1, dim))\n","\n","        # transformer\n","        self.transformer = Transformer(\n","            dim=dim,\n","            depth=depth,\n","            heads=heads,\n","            dim_head=dim_head,\n","            attn_dropout=attn_dropout,\n","            ff_dropout=ff_dropout,\n","            sparse_topk=sparse_topk\n","        )\n","\n","        # output\n","        self.to_logits = nn.Sequential(\n","            nn.LayerNorm(dim),\n","            nn.ReLU(),\n","            nn.Linear(dim, dim_out)\n","        )\n","\n","    def forward(self, x_categ, x_numer, return_attn=False):\n","        tokens = []\n","\n","        if self.num_categories > 0:\n","            x_categ = x_categ + self.categories_offset\n","            tokens.append(self.categorical_embeds(x_categ))\n","\n","        if self.num_continuous > 0:\n","            tokens.append(self.numerical_embedder(x_numer))\n","\n","        x = torch.cat(tokens, dim=1)\n","        b = x.size(0)\n","        cls = repeat(self.cls_token, '1 1 d -> b 1 d', b=b)\n","        x = torch.cat([cls, x], dim=1)\n","\n","        x, attns = self.transformer(x, return_attn=True)\n","        logits = self.to_logits(x[:, 0])\n","\n","        return (logits, attns) if return_attn else logits"]},{"cell_type":"markdown","metadata":{"id":"GQbua9hnyb3t"},"source":["======================================================================="]},{"cell_type":"code","source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")"],"metadata":{"id":"xw2OxaMb9nHI","executionInfo":{"status":"ok","timestamp":1760890031584,"user_tz":-480,"elapsed":2,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":46,"outputs":[]},{"cell_type":"code","execution_count":47,"metadata":{"executionInfo":{"elapsed":7,"status":"ok","timestamp":1760890109325,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"},"user_tz":-480},"id":"GP2nhw8Hx73H"},"outputs":[],"source":["# Define TabTransformer model\n","model = FTTransformer(\n","    categories=cat_dims,      # dimensions of categorical columns\n","    num_continuous=len(features) - len(cat_dims), # number of continuous values\n","    dim=32,\n","    dim_out=1,                # binary classification\n","    depth=6,\n","    heads=8,\n","    attn_dropout=0.1,\n","    ff_dropout=0.1,\n","    num_special_tokens = 2,\n","    sparse_topk=8\n",").to(device)"]},{"cell_type":"code","source":["from sklearn.utils.class_weight import compute_class_weight\n","from sklearn.metrics import precision_recall_curve, average_precision_score"],"metadata":{"id":"EloRm9Y5u9n0","executionInfo":{"status":"ok","timestamp":1760890112476,"user_tz":-480,"elapsed":10,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":48,"outputs":[]},{"cell_type":"code","source":["def get_best_threshold(y_true, y_probs, metric=\"f1\"):\n","    precision, recall, thresholds = precision_recall_curve(y_true, y_probs)\n","\n","    # Compute F1 for each threshold\n","    f1_scores = 2 * precision * recall / (precision + recall + 1e-8)\n","    auc_pr = average_precision_score(y_true, y_probs)\n","\n","    if metric == \"f1\":\n","        best_idx = np.argmax(f1_scores)\n","        best_score = f1_scores[best_idx]\n","    elif metric == \"precision\":\n","        best_idx = np.argmax(precision)\n","        best_score = precision[best_idx]\n","    elif metric == \"recall\":\n","        best_idx = np.argmax(recall)\n","        best_score = recall[best_idx]\n","    else:\n","        raise ValueError(\"metric must be one of: 'f1', 'precision', or 'recall'\")\n","\n","    best_threshold = thresholds[best_idx] if best_idx < len(thresholds) else 0.5\n","\n","    metrics = {\n","        \"best_metric\": metric,\n","        \"best_score\": best_score,\n","        \"best_threshold\": best_threshold,\n","        \"auc_pr\": auc_pr,\n","        \"precision_curve\": precision,\n","        \"recall_curve\": recall,\n","        \"f1_curve\": f1_scores,\n","        \"thresholds\": thresholds\n","    }\n","\n","    return best_threshold, metrics"],"metadata":{"id":"rakESQqwu-mZ","executionInfo":{"status":"ok","timestamp":1760890114801,"user_tz":-480,"elapsed":5,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"execution_count":49,"outputs":[]},{"cell_type":"code","execution_count":50,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OquETEtzzZ-V","executionInfo":{"status":"ok","timestamp":1760890572551,"user_tz":-480,"elapsed":447613,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"b6901f7e-a1ba-42bc-c409-599a7627cd62"},"outputs":[{"output_type":"stream","name":"stdout","text":["\n","Epoch 1/10\n","Train Loss: 0.3652 | Val Loss: 0.7337 | Val Acc: 0.9990 | Val AUC-PR: 0.6643 | Best F1: 0.7132 | Best Thresh: 0.9882\n","\n","Epoch 2/10\n","Train Loss: 0.3276 | Val Loss: 0.3845 | Val Acc: 0.9992 | Val AUC-PR: 0.6113 | Best F1: 0.7603 | Best Thresh: 0.9960\n","\n","Epoch 3/10\n","Train Loss: 0.2890 | Val Loss: 0.4254 | Val Acc: 0.9992 | Val AUC-PR: 0.5917 | Best F1: 0.7559 | Best Thresh: 0.9938\n","\n","Epoch 4/10\n","Train Loss: 0.2588 | Val Loss: 0.5938 | Val Acc: 0.9990 | Val AUC-PR: 0.4416 | Best F1: 0.7176 | Best Thresh: 0.9915\n","\n","Epoch 5/10\n","Train Loss: 0.2852 | Val Loss: 0.4601 | Val Acc: 0.9990 | Val AUC-PR: 0.6576 | Best F1: 0.7111 | Best Thresh: 0.9930\n","\n","Epoch 6/10\n","Train Loss: 0.2279 | Val Loss: 0.2899 | Val Acc: 0.9988 | Val AUC-PR: 0.6346 | Best F1: 0.6944 | Best Thresh: 0.7807\n","\n","Epoch 7/10\n","Train Loss: 0.2169 | Val Loss: 0.2723 | Val Acc: 0.9988 | Val AUC-PR: 0.6419 | Best F1: 0.6901 | Best Thresh: 0.9952\n","\n","Epoch 8/10\n","Train Loss: 0.2015 | Val Loss: 0.2944 | Val Acc: 0.9985 | Val AUC-PR: 0.6191 | Best F1: 0.6216 | Best Thresh: 0.9933\n","\n","Epoch 9/10\n","Train Loss: 0.2499 | Val Loss: 0.3871 | Val Acc: 0.9986 | Val AUC-PR: 0.3938 | Best F1: 0.5424 | Best Thresh: 0.9929\n","\n","Epoch 10/10\n","Train Loss: 0.2341 | Val Loss: 0.2614 | Val Acc: 0.9987 | Val AUC-PR: 0.6545 | Best F1: 0.6525 | Best Thresh: 0.9929\n"]}],"source":["optimizer = Adam(model.parameters(), lr=1e-3)\n","\n","classes = np.unique(y_train)\n","class_weights = compute_class_weight(class_weight='balanced', classes=classes, y=y_train)\n","class_weights = torch.tensor(class_weights, dtype=torch.float).to(device)\n","\n","criterion = nn.BCEWithLogitsLoss(pos_weight=class_weights[1])  # weight the minority class\n","\n","\n","num_epochs = 10\n","best_threshold = 0.5  # initialize\n","best_f1 = 0\n","\n","\n","for epoch in range(num_epochs):\n","    print(f\"\\nEpoch {epoch+1}/{num_epochs}\")\n","    model.train()\n","    train_loss = 0.0\n","\n","    for x_categ, x_cont, y in train_loader:\n","        x_categ = x_categ.to(device)\n","        x_cont = x_cont.to(device)\n","        y = y.to(device).float().unsqueeze(1)  # float and shape (batch,1)\n","\n","        optimizer.zero_grad()\n","        preds = model(x_categ, x_cont)         # shape (batch,1)\n","        loss = criterion(preds, y)             # BCEWithLogitsLoss\n","        loss.backward()\n","        optimizer.step()\n","        train_loss += loss.item()\n","\n","    avg_train_loss = train_loss / len(train_loader)\n","\n","    # validation\n","    model.eval()\n","    val_loss = 0.0\n","    all_val_probs = []\n","    all_val_labels = []\n","\n","    with torch.no_grad():\n","        for x_categ, x_cont, y in valid_loader:\n","            x_categ = x_categ.to(device)\n","            x_cont = x_cont.to(device)\n","            y = y.to(device).float().unsqueeze(1)\n","\n","            preds = model(x_categ, x_cont)      # (batch,1)\n","            loss = criterion(preds, y)\n","            val_loss += loss.item()\n","\n","            probs = torch.sigmoid(preds).cpu().numpy().squeeze(1)\n","            all_val_probs.extend(probs)\n","            all_val_labels.extend(y.cpu().numpy().astype(int).squeeze(1).tolist())\n","\n","    avg_val_loss = val_loss / len(valid_loader)\n","\n","    # ---------- Find Best Threshold (Dynamic) ----------\n","    best_threshold, metrics = get_best_threshold(all_val_labels, all_val_probs, metric=\"f1\")\n","\n","    preds_bin = (np.array(all_val_probs) >= best_threshold).astype(int)\n","    val_acc = accuracy_score(all_val_labels, preds_bin)\n","\n","    print(f\"Train Loss: {avg_train_loss:.4f} | Val Loss: {avg_val_loss:.4f} \"\n","          f\"| Val Acc: {val_acc:.4f} | Val AUC-PR: {metrics['auc_pr']:.4f} \"\n","          f\"| Best {metrics['best_metric'].upper()}: {metrics['best_score']:.4f} \"\n","          f\"| Best Thresh: {best_threshold:.4f}\")"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"0_u9H5FB55j0","executionInfo":{"status":"ok","timestamp":1760890613103,"user_tz":-480,"elapsed":5015,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}}},"outputs":[],"source":["# 5️⃣ Final test evaluation\n","model.eval()\n","all_test_preds = []\n","\n","with torch.no_grad():\n","    for x_categ, x_cont, _ in test_loader:\n","        x_categ = x_categ.to(device)\n","        x_cont = x_cont.to(device)\n","\n","        preds = model(x_categ, x_cont)\n","        probs = torch.sigmoid(preds).cpu().numpy().squeeze(1)\n","        all_test_preds.extend((probs >= best_threshold).astype(int))\n","\n","y_pred = np.array(all_test_preds)"]},{"cell_type":"code","execution_count":52,"metadata":{"id":"zGZ9KqXK0AiS","colab":{"base_uri":"https://localhost:8080/","height":472},"executionInfo":{"status":"ok","timestamp":1760890635688,"user_tz":-480,"elapsed":191,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"cbb9a8c3-d9a3-417c-ac67-d024b8bc202c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAgwAAAHHCAYAAADTQQDlAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAARwpJREFUeJzt3XlcVdX+//H3AeWAyuAIkohTDqRJahGZ041EM9OsWw4Vjl1LGyTNbHBq8H61nEsbxbx60wattCzU1Ewa1MghNQdMS0Fz4AiKIOzfH17OrxPa4bgPgu7X08d+XM/ea6/92efhhU+ftdbeNsMwDAEAAPwNn9IOAAAAlH0kDAAAwC0SBgAA4BYJAwAAcIuEAQAAuEXCAAAA3CJhAAAAbpEwAAAAt0gYAACAWyQMwF/s2rVLHTt2VHBwsGw2m5YsWeLV/vft2yebzaakpCSv9ns5a9++vdq3b1/aYQD4GyQMKJP27Nmjf/3rX6pXr578/f0VFBSk1q1ba9q0aTp9+nSJXjshIUFbtmzRiy++qHnz5qlVq1Yler1LqW/fvrLZbAoKCjrv97hr1y7ZbDbZbDa9/PLLHvd/8OBBjR07VqmpqV6IFkBZUq60AwD+atmyZfrnP/8pu92uBx54QE2bNlVubq7WrVunESNGaNu2bXrjjTdK5NqnT59WSkqKnnnmGQ0dOrRErhEZGanTp0+rfPnyJdK/O+XKldOpU6f06aef6p577nE5Nn/+fPn7+ysnJ+ei+j548KDGjRunOnXqKDo6utjnffnllxd1PQCXDgkDypS0tDT17NlTkZGRWrVqlWrWrOk8NmTIEO3evVvLli0rsesfOXJEkhQSElJi17DZbPL39y+x/t2x2+1q3bq1/vvf/xZJGBYsWKAuXbroww8/vCSxnDp1ShUqVJCfn98luR6Ai8eQBMqUiRMnKisrS2+//bZLslCoQYMGeuyxx5yfz549q+eff17169eX3W5XnTp19PTTT+vMmTMu59WpU0e333671q1bpxtuuEH+/v6qV6+e3n33XWebsWPHKjIyUpI0YsQI2Ww21alTR9K5Un7h3/9s7NixstlsLvuSk5N18803KyQkRJUqVVKjRo309NNPO49faA7DqlWr1KZNG1WsWFEhISHq1q2btm/fft7r7d69W3379lVISIiCg4PVr18/nTp16sJf7F/07t1bn3/+uU6cOOHc98MPP2jXrl3q3bt3kfbHjh3T8OHD1axZM1WqVElBQUHq3LmzfvrpJ2eb1atX6/rrr5ck9evXzzm0UXif7du3V9OmTbVx40a1bdtWFSpUcH4vf53DkJCQIH9//yL3Hx8fr8qVK+vgwYPFvlcA3kHCgDLl008/Vb169XTTTTcVq/3AgQM1evRotWjRQlOmTFG7du00YcIE9ezZs0jb3bt36+6779att96qV155RZUrV1bfvn21bds2SVKPHj00ZcoUSVKvXr00b948TZ061aP4t23bpttvv11nzpzR+PHj9corr+iOO+7QN99887fnrVixQvHx8Tp8+LDGjh2rxMRErV+/Xq1bt9a+ffuKtL/nnnt08uRJTZgwQffcc4+SkpI0bty4YsfZo0cP2Ww2ffTRR859CxYsUOPGjdWiRYsi7ffu3aslS5bo9ttv1+TJkzVixAht2bJF7dq1c/7ybtKkicaPHy9JevDBBzVv3jzNmzdPbdu2dfZz9OhRde7cWdHR0Zo6dao6dOhw3vimTZum6tWrKyEhQfn5+ZKk119/XV9++aVmzJih8PDwYt8rAC8xgDIiMzPTkGR069atWO1TU1MNScbAgQNd9g8fPtyQZKxatcq5LzIy0pBkrF271rnv8OHDht1uN5544gnnvrS0NEOSMWnSJJc+ExISjMjIyCIxjBkzxvjz/42mTJliSDKOHDlywbgLrzFnzhznvujoaKNGjRrG0aNHnft++uknw8fHx3jggQeKXK9///4ufd55551G1apVL3jNP99HxYoVDcMwjLvvvtu45ZZbDMMwjPz8fCMsLMwYN27ceb+DnJwcIz8/v8h92O12Y/z48c59P/zwQ5F7K9SuXTtDkjF79uzzHmvXrp3Lvi+++MKQZLzwwgvG3r17jUqVKhndu3d3e48ASgYVBpQZDodDkhQYGFis9p999pkkKTEx0WX/E088IUlF5jpERUWpTZs2zs/Vq1dXo0aNtHfv3ouO+a8K5z58/PHHKigoKNY5hw4dUmpqqvr27asqVao491977bW69dZbnff5Z4MHD3b53KZNGx09etT5HRZH7969tXr1aqWnp2vVqlVKT08/73CEdG7eg4/PuR8X+fn5Onr0qHO4ZdOmTcW+pt1uV79+/YrVtmPHjvrXv/6l8ePHq0ePHvL399frr79e7GsB8C4SBpQZQUFBkqSTJ08Wq/2vv/4qHx8fNWjQwGV/WFiYQkJC9Ouvv7rsr127dpE+KleurOPHj19kxEXde++9at26tQYOHKjQ0FD17NlTixYt+tvkoTDORo0aFTnWpEkT/fHHH8rOznbZ/9d7qVy5siR5dC+33XabAgMDtXDhQs2fP1/XX399ke+yUEFBgaZMmaKrr75adrtd1apVU/Xq1bV582ZlZmYW+5pXXXWVRxMcX375ZVWpUkWpqamaPn26atSoUexzAXgXCQPKjKCgIIWHh2vr1q0enffXSYcX4uvre979hmFc9DUKx9cLBQQEaO3atVqxYoXuv/9+bd68Wffee69uvfXWIm3NMHMvhex2u3r06KG5c+dq8eLFF6wuSNJLL72kxMREtW3bVv/5z3/0xRdfKDk5Wddcc02xKynSue/HEz/++KMOHz4sSdqyZYtH5wLwLhIGlCm333679uzZo5SUFLdtIyMjVVBQoF27drnsz8jI0IkTJ5wrHryhcuXKLisKCv21iiFJPj4+uuWWWzR58mT9/PPPevHFF7Vq1Sp99dVX5+27MM6dO3cWObZjxw5Vq1ZNFStWNHcDF9C7d2/9+OOPOnny5Hknihb64IMP1KFDB7399tvq2bOnOnbsqLi4uCLfSXGTt+LIzs5Wv379FBUVpQcffFATJ07UDz/84LX+AXiGhAFlypNPPqmKFStq4MCBysjIKHJ8z549mjZtmqRzJXVJRVYyTJ48WZLUpUsXr8VVv359ZWZmavPmzc59hw4d0uLFi13aHTt2rMi5hQ8w+utSz0I1a9ZUdHS05s6d6/ILeOvWrfryyy+d91kSOnTooOeff14zZ85UWFjYBdv5+voWqV68//77+v333132FSY250uuPDVy5Ejt379fc+fO1eTJk1WnTh0lJCRc8HsEULJ4cBPKlPr162vBggW699571aRJE5cnPa5fv17vv/+++vbtK0lq3ry5EhIS9MYbb+jEiRNq166dvv/+e82dO1fdu3e/4JK9i9GzZ0+NHDlSd955px599FGdOnVKs2bNUsOGDV0m/Y0fP15r165Vly5dFBkZqcOHD+u1115TrVq1dPPNN1+w/0mTJqlz586KjY3VgAEDdPr0ac2YMUPBwcEaO3as1+7jr3x8fPTss8+6bXf77bdr/Pjx6tevn2666SZt2bJF8+fPV7169Vza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RzObJ9auXauuXbsqPDxcNptNS5YscTnet2/fIss2O3Xq5NLm2LFj6tOnj4KCghQSEqIBAwYoKyvLpc3mzZvVpk0b+fv7KyIiQhMnTiwSy/vvv6/GjRvL399fzZo102effebZzaiYFYbKlSu7ZFbZ2dmKiYlRuXLnTj979qzKlSun/v37q3v37h4HAQDAlSY7O1vNmzdX//791aNHj/O26dSpk+bMmeP8bLfbXY736dNHhw4dUnJysvLy8tSvXz89+OCDWrBggSTJ4XCoY8eOiouL0+zZs7Vlyxb1799fISEhevDBByVJ69evV69evTRhwgTdfvvtWrBggbp3765NmzapadOmxb6fYiUMU6dOLXaHAACURZd6SKJz587q3Lnz37ax2+0KCws777Ht27dr+fLl+uGHH9SqVStJ0owZM3Tbbbfp5ZdfVnh4uObPn6/c3Fy988478vPz0zXXXKPU1FRNnjzZmTBMmzZNnTp10ogRIyRJzz//vJKTkzVz5kzNnj272PdTrIQhISGh2B0CAFAWlcVHQ69evVo1atRQ5cqV9Y9//EMvvPCCqlatKklKSUlRSEiIM1mQpLi4OPn4+Oi7777TnXfeqZSUFLVt21Z+fn7ONvHx8fq///s/HT9+XJUrV1ZKSooSExNdrhsfH19kiMSdi35wkyTl5OQoNzfXZV9QUJCZLgEAKNMcDofLZ7vdXmQooTg6deqkHj16qG7dutqzZ4+efvppde7cWSkpKfL19VV6erpq1Kjhck65cuVUpUoVpaenS5LS09NVt25dlzahoaHOY5UrV1Z6erpz35/bFPZRXB4nDNnZ2Ro5cqQWLVqko0ePFjmen5/vaZcAAJQ4b73eOiIiwmX/mDFjNHbsWI/769mzp/PvzZo107XXXqv69etr9erVuuWWWy46zpLi8SqJJ598UqtWrdKsWbNkt9v11ltvady4cQoPD9e7775bEjECAGCazWZ+k6QDBw4oMzPTuY0aNcor8dWrV0/VqlXT7t27JUlhYWE6fPiwS5uzZ8/q2LFjznkPYWFhysjIcGlT+NldmwvNnbgQjxOGTz/9VK+99pruuusulStXTm3atNGzzz6rl156SfPnz/e0OwAALitBQUEu28UMR5zPb7/9pqNHj6pmzZqSpNjYWJ04cUIbN250tlm1apUKCgoUExPjbLN27VqX5yMlJyerUaNGqly5srPNypUrXa6VnJys2NhYj+LzOGE4duyY6tWrJ+ncl3bs2DFJ0s0336y1a9d62h0AAJfEpX69dVZWllJTU5WamipJSktLU2pqqvbv36+srCyNGDFC3377rfbt26eVK1eqW7duatCggeLj4yVJTZo0UadOnTRo0CB9//33+uabbzR06FD17NnT+aDE3r17y8/PTwMGDNC2bdu0cOFCTZs2zWWS42OPPably5frlVde0Y4dOzR27Fht2LBBQ4cO9eh+PE4Y6tWrp7S0NElS48aNtWjRIknnKg+FL6MCAKCs8daQRHFt2LBB1113na677jpJUmJioq677jqNHj1avr6+2rx5s+644w41bNhQAwYMUMuWLfX111+7VCzmz5+vxo0b65ZbbtFtt92mm2++WW+88YbzeHBwsL788kulpaWpZcuWeuKJJzR69GjnkkpJuummm7RgwQK98cYbat68uT744AMtWbLEo2cwSJLNMAzDkxOmTJkiX19fPfroo1qxYoW6du0qwzCUl5enyZMn67HHHvMoADMcDoeCg4NlbzZINl8/9ycAl6HjP8ws7RCAEuNwOBRaNViZmZkltsqu8HdF37nfyq9CpYvuJ/dUlpISbizRWMsyj1dJDBs2zPn3uLg47dixQxs3blSDBg107bXXejU4AAC8xVurJKzK1HMYJCkyMlKRkZHeiAUAgBJzMcMKfz3fyoqVMEyfPr3YHT766KMXHQwAACWFt1WaU6yEYcqUKcXqzGazkTAAAHAFKlbCULgqoqzav/plS05AAQAUn48uYmngX863MtNzGAAAuBwwJGGO1RMmAABQDFQYAACWYLNJPqySuGgkDAAAS/AxmTCYOfdKwJAEAABw66IShq+//lr33XefYmNj9fvvv0uS5s2bp3Xr1nk1OAAAvOVSv3zqSuNxwvDhhx8qPj5eAQEB+vHHH3XmzBlJUmZmpl566SWvBwgAgDcUDkmY2azM44ThhRde0OzZs/Xmm2+qfPnyzv2tW7fWpk2bvBocAAAoGzye9Lhz5061bdu2yP7g4GCdOHHCGzEBAOB1vEvCHI8rDGFhYdq9e3eR/evWrVO9evW8EhQAAN5W+LZKM5uVeZwwDBo0SI899pi+++472Ww2HTx4UPPnz9fw4cP10EMPlUSMAACY5uOFzco8HpJ46qmnVFBQoFtuuUWnTp1S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\n"},"metadata":{}}],"source":["# Confusion Matrix\n","cm = confusion_matrix(y_test, y_pred)\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm)\n","disp.plot(cmap=plt.cm.Blues)\n","plt.title(\"Confusion Matrix\")\n","plt.show()"]},{"cell_type":"code","source":["# Accuracy, Precision, Recall, F1-Score\n","accuracy = accuracy_score(y_test, y_pred)\n","precision = precision_score(y_test, y_pred)\n","recall = recall_score(y_test, y_pred)\n","f1 = f1_score(y_test, y_pred)\n","auc = roc_auc_score(y_test, y_pred)\n","\n","\n","# Print individual scores\n","print(f\"Accuracy: {accuracy:.4f}\")\n","print(f\"Precision: {precision:.4f}\")\n","print(f\"Recall: {recall:.4f}\")\n","print(f\"F1-Score: {f1:.4f}\")\n","print(f\"ROC-AUC: {auc:.4f}\")\n","\n","# Classification report for a detailed overview\n","print(classification_report(y_test, y_pred))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VhO2p17A9x-K","executionInfo":{"status":"ok","timestamp":1760890639989,"user_tz":-480,"elapsed":37,"user":{"displayName":"Munkhzaya Bayanbat","userId":"02841352344795048115"}},"outputId":"a8ddb7b9-0c6d-4e61-98f7-9d56fd0ece0f"},"execution_count":53,"outputs":[{"output_type":"stream","name":"stdout","text":["Accuracy: 0.9989\n","Precision: 0.6792\n","Recall: 0.7347\n","F1-Score: 0.7059\n","ROC-AUC: 0.8670\n","              precision    recall  f1-score   support\n","\n","           0       1.00      1.00      1.00     28432\n","           1       0.68      0.73      0.71        49\n","\n","    accuracy                           1.00     28481\n","   macro avg       0.84      0.87      0.85     28481\n","weighted avg       1.00      1.00      1.00     28481\n","\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"iogJ7zeoAorG"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"gpuType":"A100","authorship_tag":"ABX9TyOU/pTrNNfvyu193DJGE19m"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}